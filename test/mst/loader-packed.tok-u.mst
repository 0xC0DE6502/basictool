  210 V=FALSE
  211 ON ERROR GOTO 100
  310 V=FNu(&49,&FF,0)=&49
  311 ON ERROR PROCe
  510 CLOSE#0
  511 A%=&85
  512 X%=135
  513 po=(USR&FFF4 AND&FFFF00)DIV&100
  514 IFpo=&8000 AND HIMEM<&8000 THEN MODE135:CHAIN"LOADER"
  610 VDU23,16,0,254,0;0;0;
  611 f=&409
  612 C=&40A
  613 ?&40B=3
  614 s=&403
  615 DIMb%256
  616 A%=0
  617 X%=1
  618 h=(USR&FFF4 AND&FF00)DIV&100
  619 IFV THENh=1
  710 e=h=0
  810 ON ERROR GOTO 1010
 1010 ON ERROR PROCe
 1110 sh=po=&8000
 1111 F$=""
 1112 t=PAGE<&E00
 1113 IFt THEN PROCd
 1210 pr=FALSE
 1211 IFsh AND NOTt THEN PROCa
 1310 PROCt
 1311 MODE135
 1312 VDU23,1,0;0;0;0;
 1313 ?f=7
 1314 ?C=4
 1315 IFe THEN VDU19,0,?C,0;0,19,7,?f,0;0
 1410 IFe THEN PROCl ELSE PROCb
 1510 z=&87
 1511 no=z+16
 1512 S=&83
 1513 T=&83
 1514 U=&81
 1515 L=0
 1516 IFe THENz=0:no=32:S=0:L=32
 1610 PRINT CHR$S;"Hardware detected:"
 1611 v=VPOS
 1612 IFt THEN PRINT CHR$z;"  Second processor";t$
 1710 IFsh THEN PRINT CHR$z;"  Shadow RAM ";F$
 1810 IFG$<>""THEN PRINT CHR$z;"  ";G$
 1910 IFv=VPOS THEN PRINT CHR$z;"  None"
 2010 PRINT
 2011 K=VPOS
 2012 PROCc
 2013 IFt ORsh THEN PROCm ELSE?s=7+e:m=VPOS:PROCs:PROCp:REPEAT UNTIL FNh(GET)
 2110 IF?s=7 THEN?f=6
 2210 PRINT TAB(0,sp);CHR$z;"Loading:";
 2211 ps=POS
 2212 PRINT"                               ";
 2213 PRINT TAB(ps,sp);CHR$no;
 2214 VDU23,255,-1;-1;-1;-1;
 2215 IFt THEN*/:0.$.CACHE2P
 2310 IF NOTt THEN?&408=FNc DIV256
 2410 O=FNf
 2411 IFO<>4 THENp$=FNp
 2510 IFO=5 THEN*DIR
 2610 ON ERROR GOTO 2810
 2710 IFO=4 THEN PROCo("DIR S")ELSE*DIR SAVES
 2810 ON ERROR PROCe
 2910 IFO=4 THENf$="/"+b$ELSEf$=p$+".DATA"
 3010 IF LENf$>=49 THEN PROCi("Game data path too long")
 3110 P=&42F
 3111 $P=f$
 3210 IFO=4 THEN PROCo($P)ELSE PROCo("/"+p$+"."+b$)
 3310 END
 3410 DEF PROCe
 3411 CLS
 3412 REPORT
 3413 PRINT" at line ";ERL
 3414 PROCf
 3510 DEF PROCi(m$)
 3511 VDU28,0,sp,39,K,12
 3512 PROCr(z,m$)
 3513 PRINT
 3610 DEF PROCf
 3810 END
 3910 DEF PROCl
 3911 VDU23,128,0;0,255,255,0,0;
 3912 PRINT TAB(0,23);STRING$(40,CHR$128);"Powered by Ozmoo 6.0 (Acorn alpha 16)";
 3913 IF POS=0 THEN VDU30,11 ELSE VDU30
 4010 PRINT"Hollywoo";
 4011 IF POS>0 THEN PRINT
 4110 PRINT STRING$(40,CHR$128);
 4111 PRINT
 4112 sp=22
 4113 ENDPROC
 4210 DEF PROCb
 4211 PRINT TAB(0,21);
 4212 PRINT
 4213 PRINT
 4214 PRINT CHR$147;",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,";
 4215 PRINT CHR$131;"Powered by Ozmoo 6.0 (Acorn alpha 16)";
 4216 IF POS=0 THEN VDU30,11 ELSE VDU30
 4310 PRINT CHR$141;"Hollywoo"
 4311 PRINT CHR$141;"Hollywoo"
 4312 PRINT CHR$147;",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,";
 4313 PRINT
 4314 PRINT TAB(0,4);
 4315 sp=22
 4316 ENDPROC
 4410 DEF PROCc
 4411 IFt THENb$=":0.$.OZMOO2P":ENDPROC
 4510 PROCh
 4511 IF PAGE>Y THEN PROCi("Sorry, you need PAGE<=&"+STR$~Y+"; it is &"+STR$~ PAGE+".")
 4610 M=Y-PAGE
 4611 IFV THENvm=&2C00 ELSEvm=0
 4710 Q=sw-vm
 4711 IFZ THEN PROCk:ENDPROC
 4810 Q=Q-sr
 4811 IFQ<0 THENM=M+Q:Q=0
 4910 PROCu(&400)
 4911 IFM<0 THEN PROC_(-M,"main or sideways RAM")
 5010 R=M
 5011 ENDPROC
 5110 DEF PROCk
 5111 Q=Q-sr
 5112 PROCu(&400)
 5113 IFQ<0 THEN PROC_(-Q,"sideways RAM")
 5210 IFM<0 THEN PROC_(-M,"main RAM")
 5310 R=M
 5311 ENDPROC
 5410 DEF PROCu(n)
 5411 IFvm>0 THENd=FNm(n,vm):vm=vm-d:n=n-d
 5510 IFQ>0 THENd=FNm(n,Q):Q=Q-d:n=n-d
 5610 M=M-n
 5611 ENDPROC
 5710 DEF FNc
 5711 p=PAGE
 5712 IF NOTsh THEN=p
 5810 IF NOTsa THEN=p
 5910 IF?s=0 THEN=p
 6010 sd=FNm(4*256,R)
 6011 IFp+sd>=&3000 THENsd=&3000-p
 6110 IFsd<512 THENsd=0
 6210 =p+sd
 6310 DEF FNm(a,b)
 6311 IFa<b THEN=a ELSE=b
 6410 DEF FNu(A%,X%,Y%)=(USR&FFF4 AND&FF00)DIV&100
 6510 DEF PROCh
 6511 IFe THENb$=":0.$.OZMOOE":Y=6400:sr=&3000:Z=TRUE:ENDPROC
 6610 IFsh THENb$=":0.$.OZMOOSH":Y=8960:sr=0:Z=FALSE:ENDPROC
 6710 b$=":0.$.OZMOOB"
 6711 Y=8448
 6712 sr=-&400
 6713 Z=FALSE
 6714 ENDPROC
 6810 DEF PROCm
 6811 DIMm(8),A(8)
 6812 j=2
 6813 q=1
 6814 DIMm$(j,q),B(j)
 6815 m$(0,0)="0) 80x32"
 6816 m$(0,1)="3) 80x25"
 6817 m$(1,0)="4) 40x32"
 6818 m$(1,1)="6) 40x25"
 6819 m$(2,0)="7) 40x25   "
 6820 m$(2,1)="   teletext"
 6821 IFe THENj=1:B$="0346"ELSEB$="03467"
 6910 FORy=q TO0 STEP-1
 6911 FORx=0 TOj
 6912 r=VAL LEFT$(m$(x,y),1)
 6913 m(r)=x
 6914 A(r)=y
 6915 NEXT
 6916 NEXT
 6917 PRINT CHR$S;"Screen mode:";CHR$z;CHR$L;"(hit ";
 6918 H$=""
 6919 FORi=1 TO LEN(B$)
 6920 PRINTH$;MID$(B$,i,1);
 6921 H$="/"
 6922 NEXT
 6923 PRINT" to change)"
 6924 u=VPOS
 6925 IFj=2 THENg=0 ELSEg=5
 7010 FORy=0 TOq
 7011 PRINT TAB(0,u+y);CHR$z;
 7012 FORx=0 TOj
 7013 B(x)=POS
 7014 PRINT SPC2;m$(x,y);SPC(2+g);
 7015 NEXT
 7016 NEXT
 7017 m=u+q+2
 7018 C$="7"
 7019 IF INSTR(B$,C$)=0 THENC$=RIGHT$(B$,1)
 7110 x=m(VALC$)
 7111 y=A(VALC$)
 7112 PROCg(x,y,TRUE)
 7113 PROCp
 7114 REPEAT
 7115 o=x
 7116 ol=y
 7117 k=GET
 7118 IFk=136 ANDx>0 THENx=x-1
 7210 IFk=137 ANDx<j THENx=x+1
 7310 IFk=138 ANDy<q THENy=y+1
 7410 IFk=139 ANDy>0 THENy=y-1
 7510 k$=CHR$k
 7511 IF INSTR(B$,k$)<>0 THENx=m(VALk$):IF NOT FNi(x)THENy=A(VALk$)
 7610 IFx<>o OR(y<>ol AND NOT FNi(x))THEN PROCg(o,ol,FALSE):PROCg(x,y,TRUE)
 7710 UNTIL FNh(k)
 7711 ENDPROC
 7810 DEF FNh(k)
 7811 IFe ANDk=2 THEN?C=(?C+1)MOD8:VDU19,0,?C,0;0
 7910 IFe ANDk=6 THEN?f=(?f+1)MOD8:VDU19,7,?f,0;0
 8010 =k=32 ORk=13
 8110 DEF PROCg(x,y,on)
 8111 IFon AND FNi(x)THEN?s=7 ELSE IFon THEN?s=VAL(m$(x,y))
 8210 IFon THEN PROCs
 8310 IFe THEN PROCn(x,y,on):ENDPROC
 8410 IF FNi(x)THEN PROCA(x,0,on):y=1
 8510 DEF PROCA(x,y,on)
 8511 IFx<2 THEN PRINT TAB(B(x)+3+LENm$(x,y),u+y);CHR$z;CHR$156;
 8610 PRINT TAB(B(x)-1,u+y);
 8611 IFon THEN PRINT CHR$U;CHR$157;CHR$T ELSE PRINT"  ";CHR$z
 8710 ENDPROC
 8810 DEF PROCn(x,y,on)
 8811 PRINT TAB(B(x),u+y);
 8812 IFon THEN COLOUR135:COLOUR0 ELSE COLOUR128:COLOUR7
 8910 PRINT SPC(2);m$(x,y);SPC(2);
 8911 COLOUR128
 8912 COLOUR7
 8913 ENDPROC
 9010 DEF PROCr(c,m$)
 9011 E$=CHR$c+STRING$(POS," ")
 9012 i=1
 9013 VDUc
 9014 REPEAT
 9015 sc=INSTR(m$," ",i+1)
 9016 IFsc=0 THENw$=MID$(m$,i)ELSEw$=MID$(m$,i,sc-i)
 9110 ne=POS+LENw$
 9111 IFne<40 THEN PRINTw$;" ";ELSE IFne=40 THEN PRINTw$;ELSE PRINT'E$;w$;" ";
 9210 IF POS=0 ANDsc<>0 THEN PRINTE$;
 9310 i=sc+1
 9311 UNTILsc=0
 9312 IF POS<>0 THEN PRINT
 9410 ENDPROC
 9510 DEF PROCd
 9511 tu=0<>?&8F
 9512 ?&40E=tu
 9513 IFtu THENt$=" (256K)"ELSEt$=" (64K)"
 9610 ENDPROC
 9710 DEF PROCa
 9711 sa=TRUE
 9712 IFV THEN PROCw:ENDPROC
 9810 IFe AND FNu(&EF,0,&FF)=&80 THEN PROCv:ENDPROC
 9910 IFh=2 THEN PROCB:ENDPROC
10010 IFh>=3 THEN PROCC:ENDPROC
10110 sa=FALSE
10111 F$="(screen only)"
10112 ENDPROC
10210 DEF PROCv
10211 FORo%=0 TO2 STEP2
10212 P%=&8C4
10213 [OPT o%
10214 CMP#&30
10215 BCS F
10216 STA l+2
10217 LDX#0
10218 .E
10219 .l
10220 LDA&FF00,X
10221 BIT ou
10222 JSR&FBFD
10223 INX
10224 BNE E
10225 .ou
10226 RTS
10227 .F
10228 STY st+2
10229 TAY
10230 LDX#0
10231 .G
10232 CLV
10233 JSR&FBFD
10234 .st
10235 STA&FF00,X
10236 INX
10237 BNE G
10238 RTS
10239 ]
10240 NEXT
10241 ENDPROC
10310 DEF PROCw
10311 FORo%=0 TO2 STEP2
10312 P%=&8C4
10313 [OPT o%
10314 STA W+2
10315 STY s_+2
10316 LDA#&6C
10317 LDX#1
10318 JSR&FFF4
10319 LDY#0
10320 .H
10321 .W
10322 LDA&FF00,Y
10323 .s_
10324 STA&FF00,Y
10325 DEY
10326 BNE H
10327 LDA#&6C
10328 LDX#0
10329 JSR&FFF4
10330 RTS
10331 ]
10332 NEXT
10333 ENDPROC
10410 DEF PROCB
10411 pr=FALSE
10412 N=&D9F
10413 FORve=0 TO26
10414 IFN?(ve*3+2)>=128 THENpr=TRUE
10510 NEXT
10511 IFpr THEN PROCD:ENDPROC
10610 so=&AF00
10611 FORo%=0 TO2 STEP2
10612 P%=&8C4
10613 [OPT o%
10614 LDX&F4
10615 STX X+1
10616 LDX#128
10617 STX&F4
10618 STX&FE30
10619 JMP so
10620 .su
10621 .X
10622 LDA#0
10623 STA&F4
10624 STA&FE30
10625 RTS
10626 ]
10627 O%=b%
10628 P%=so
10629 sy=O%
10630 [OPT o%+4
10631 STA W+2
10632 STY s_+2
10633 LDY#0
10634 .H
10635 .W
10636 LDA&FF00,Y
10637 .s_
10638 STA&FF00,Y
10639 DEY
10640 BNE H
10641 JMP su
10642 ]
10643 sl=O%
10644 P%=O%
10645 [OPT o%
10646 .I
10710 LDA&F4
10711 STA&70
10712 LDA#128
10713 STA&F4
10714 STA&FE30
10715 LDY#sl-sy-1
10716 .J
10717 LDA sy,Y
10718 STA so,Y
10719 DEY
10720 CPY#&FF
10721 BNE J
10722 LDA&70
10723 STA&F4
10724 STA&FE30
10725 RTS
10726 ]
10727 NEXT
10728 CALLI
10729 ENDPROC
10810 DEF PROCD
10811 F$="(via OS)"
10812 FORo%=0 TO2 STEP2
10813 P%=&8C4
10814 [OPT o%
10815 CMP#&30
10816 BCS F
10817 STA W+2
10818 STY&D7
10819 LDY#0
10820 STY&D6
10821 .E
10822 .W
10823 LDA&FF00,Y
10824 JSR&FFB3
10825 INY
10826 BNE E
10827 RTS
10828 .F
10829 STA&F7
10830 STY sb+2
10831 LDY#0
10832 STY&F6
10833 .G
10834 JSR&FFB9
10835 .sb
10836 STA&FF00
10837 INC&F6
10838 INC sb+1
10839 BNE G
10840 RTS
10841 ]
10842 NEXT
10843 ENDPROC
10910 DEF PROCC
10911 FORo%=0 TO2 STEP2
10912 P%=&8C4
10913 [OPT o%
10914 STA W+2
10915 STY s_+2
10916 LDA#4
10917 TSB&FE34
10918 LDY#0
10919 .H
10920 .W
10921 LDA&FF00,Y
10922 .s_
10923 STA&FF00,Y
10924 DEY
10925 BNE H
10926 LDA#4
10927 TRB&FE34
10928 RTS
10929 ]
10930 NEXT
10931 ENDPROC
11010 DEF PROCt
11011 sn=FNe(&904)
11012 G$=""
11013 sj=0
11014 IF NOTt THEN PROCE
11110 IF FNe(&903)>2 THENG$="("+STR$(sn*16)+"K unsupported sideways RAM)"
11210 sw=&4000*FNe(&904)-sj
11211 IFsn=0 THEN ENDPROC
11310 IFsw<=12*1024 THENG$="12K private RAM":ENDPROC
11410 G$=STR$(sw DIV1024)+"K sideways RAM (bank"
11411 IFsn>1 THENG$=G$+"s"
11510 G$=G$+" &"
11511 FORi=0 TOsn-1
11512 D=FNe(&905+i)
11513 IFD>=64 THENA$="P"ELSEA$=STR$~D
11610 G$=G$+A$
11611 NEXT
11612 G$=G$+")"
11613 ENDPROC
11710 DEF PROCE
11711 IFsn<9 ANDV THENsn?&905=64:sn=sn+1:?&904=sn:sj=16*1024-&2C00
11810 IFsn<9 ANDh=2 THEN IF NOTpr THENsn?&905=128:sn=sn+1:?&904=sn:sj=16*1024-&2E00
11910 ENDPROC
12010 DEF PROCF(D$)
12011 PROCi("Sorry, this game won't run on "+D$+".")
12110 DEF PROC_(A,r$)
12111 PROCi("Sorry, you need at least "+STR$(A/1024)+"K more "+r$+".")
12210 DEF PROCs
12211 w=w
12212 IFw=0 THEN PRINT TAB(0,m);CHR$S;"In-game controls:"ELSE PRINT TAB(0,m+1);
12310 PRINT CHR$z;"  SHIFT:  show next page of text"
12311 IF?s=7 THEN PRINT CHR$z;"  CTRL-F: change status line colour"
12410 IF?s=7 THEN PRINT CHR$z;"  CTRL-I: change input colour      "
12510 IF?s<>7 THEN PRINT CHR$z;"  CTRL-F: change foreground colour "
12610 IF?s<>7 THEN PRINT CHR$z;"  CTRL-B: change background colour "
12710 IF?s<>7 THEN PRINT CHR$z;"  CTRL-S: change scrolling mode    "
12810 IF VPOS<w THEN PRINT SPC(40*(w-VPOS));
12910 w=VPOS
12911 ENDPROC
13010 DEF PROCp
13011 PRINT TAB(0,sp);CHR$z;"Press SPACE/RETURN to start the game...";
13012 ENDPROC
13110 DEF FNi(x)=LEFT$(m$(x,0),1)="7"
13210 DEF PROCo($b%)
13211 X%=b%
13212 Y%=X%DIV256
13213 CALL&FFF7
13214 ENDPROC
13310 DEF FNe(B)
13311 !b%=&FFFF0000 ORB
13312 A%=5
13313 X%=b%
13314 Y%=b%DIV256
13315 CALL&FFF1
13316 =b%?4
13410 DEF FNf
13411 A%=0
13412 Y%=0
13413 =USR&FFDA AND&FF
13510 DEF FNp
13511 DIMd%256
13512 p$=""
13513 REPEAT
13514 b%!1=d%
13515 A%=6
13516 X%=b%
13517 Y%=b%DIV256
13518 CALL&FFD1
13519 na=d%+1+?d%
13520 na?(1+?na)=13
13521 n$=FNs($(na+1))
13522 p$=n$+"."+p$
13523 IFn$<>"$"ANDn$<>"&"THEN*DIR ^
13610 UNTILn$="$"ORn$="&"
13611 p$=LEFT$(p$,LEN(p$)-1)
13612 ?na=13
13613 d$=FNs($(d%+1))
13614 IFd$<>""THENp$=":"+d$+"."+p$
13710 PROCo("DIR "+p$)
13711 =p$
13810 DEF FNs(s$)
13811 s$=s$+" "
13812 REPEAT
13813 s$=LEFT$(s$,LEN(s$)-1)
13814 UNTIL RIGHT$(s$,1)<>" "
13815 =s$
13910 DEF FNa(a,b)
13911 IFa<b THEN=b ELSE=a
